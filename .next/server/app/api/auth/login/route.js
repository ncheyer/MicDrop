"use strict";(()=>{var e={};e.id=873,e.ids=[873],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3470:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>w,patchFetch:()=>g,requestAsyncStorage:()=>c,routeModule:()=>l,serverHooks:()=>h,staticGenerationAsyncStorage:()=>d});var a={};t.r(a),t.d(a,{POST:()=>p});var n=t(9303),o=t(8716),s=t(670),i=t(7070),u=t(6271);async function p(e){try{let{email:r,password:t}=await e.json(),a=await (0,u.So)(r,t);if(!a)return i.NextResponse.json({error:"Invalid email or password"},{status:401});let n=i.NextResponse.json({user:a});return n.cookies.set("userId",a.id,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:604800}),n}catch(e){return i.NextResponse.json({error:"Something went wrong"},{status:500})}}let l=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"/Users/noahcheyer/MicDrop/app/api/auth/login/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:c,staticGenerationAsyncStorage:d,serverHooks:h}=l,w="/api/auth/login/route";function g(){return(0,s.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:d})}},6271:(e,r,t)=>{t.d(r,{So:()=>i,r4:()=>u});let a=require("crypto");var n=t.n(a),o=t(9487);function s(e){return n().createHash("sha256").update(e).digest("hex")}async function i(e,r){try{let t=await o._.user.findUnique({where:{email:e}});if(!t)return null;let a=s(r);if(t.password!==a)return null;let{password:n,...i}=t;return i}catch(e){return console.error("Authentication error:",e),null}}async function u(e,r,t){try{if(await o._.user.findUnique({where:{email:r}}))throw Error("User already exists");let{password:a,...n}=await o._.user.create({data:{name:e,email:r,password:s(t)}});return n}catch(e){throw console.error("Create user error:",e),e}}},9487:(e,r,t)=>{t.d(r,{_:()=>n});var a=t(3524);t(2237);let n=global.prisma||new a.PrismaClient({log:["error"]})}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[948,972,237],()=>t(3470));module.exports=a})();