"use strict";(()=>{var e={};e.id=389,e.ids=[389],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4385:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>m,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>g,staticGenerationAsyncStorage:()=>k});var a={};r.r(a),r.d(a,{GET:()=>p,POST:()=>u});var s=r(9303),n=r(8716),o=r(670),i=r(7070),l=r(9487);async function p(e){try{let t=e.cookies.get("userId")?.value;if(!t)return i.NextResponse.json({error:"Unauthorized"},{status:401});let r=await l._.talkPage.findMany({where:{userId:t},include:{customGpts:!0,downloads:!0,businessLinks:!0,_count:{select:{emailCaptures:!0,analytics:{where:{event:"page_view"}}}}},orderBy:{createdAt:"desc"}});return i.NextResponse.json(r)}catch(e){return console.error("Error fetching talk pages:",e),i.NextResponse.json({error:"Failed to fetch talk pages"},{status:500})}}async function u(e){try{let t=e.cookies.get("userId")?.value;if(!t)return i.NextResponse.json({error:"Unauthorized"},{status:401});let r=await e.json(),a=r.title.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"")+"-"+Date.now().toString(36),s=await l._.talkPage.create({data:{slug:a,title:r.title,date:new Date(r.date),speakerName:r.speakerName,speakerEmail:r.speakerEmail,speakerPhoto:r.speakerPhoto,speakerBio:r.speakerBio,speakerLinkedIn:r.speakerLinkedIn,hook:r.hook,keynoteNotesUrl:r.keynoteNotesUrl,keynoteSlidesUrl:r.keynoteSlidesUrl,contactEmail:r.contactEmail,calendarLink:r.calendarLink,newsletterEnabled:r.newsletterEnabled||!1,newsletterDescription:r.newsletterDescription,newsletterSignupUrl:r.newsletterSignupUrl,published:r.published||!1,userId:t,customGpts:{create:r.customGpts||[]},downloads:{create:r.downloads||[]},businessLinks:{create:r.businessLinks||[]}},include:{customGpts:!0,downloads:!0,businessLinks:!0}});return i.NextResponse.json(s)}catch(e){return console.error("Error creating talk page:",e),i.NextResponse.json({error:"Failed to create talk page"},{status:500})}}let c=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/talk-pages/route",pathname:"/api/talk-pages",filename:"route",bundlePath:"app/api/talk-pages/route"},resolvedPagePath:"/Users/noahcheyer/MicDrop/app/api/talk-pages/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:d,staticGenerationAsyncStorage:k,serverHooks:g}=c,h="/api/talk-pages/route";function m(){return(0,o.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:k})}},9487:(e,t,r)=>{r.d(t,{_:()=>s});var a=r(3524);r(2237);let s=global.prisma||new a.PrismaClient({log:["error"]})}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[948,972,237],()=>r(4385));module.exports=a})();