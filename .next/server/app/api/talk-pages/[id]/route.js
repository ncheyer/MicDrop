"use strict";(()=>{var e={};e.id=276,e.ids=[276],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},195:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>m,patchFetch:()=>h,requestAsyncStorage:()=>k,routeModule:()=>c,serverHooks:()=>w,staticGenerationAsyncStorage:()=>g});var r={};a.r(r),a.d(r,{DELETE:()=>p,GET:()=>l,PUT:()=>u});var s=a(9303),n=a(8716),i=a(670),o=a(7070),d=a(9487);async function l(e,{params:t}){try{let a=e.cookies.get("userId")?.value;if(!a)return o.NextResponse.json({error:"Unauthorized"},{status:401});let r=await d._.talkPage.findFirst({where:{id:t.id,userId:a},include:{customGpts:!0,downloads:!0,businessLinks:!0}});if(!r)return o.NextResponse.json({error:"Talk page not found"},{status:404});return o.NextResponse.json(r)}catch(e){return console.error("Error fetching talk page:",e),o.NextResponse.json({error:"Failed to fetch talk page"},{status:500})}}async function u(e,{params:t}){try{if(!e.cookies.get("userId")?.value)return o.NextResponse.json({error:"Unauthorized"},{status:401});let a=await e.json(),r=await d._.$transaction(async e=>(await e.talkPage.update({where:{id:t.id},data:{title:a.title,date:a.date?new Date(a.date):void 0,published:a.published,speakerName:a.speakerName,speakerEmail:a.speakerEmail,speakerPhoto:a.speakerPhoto,speakerBio:a.speakerBio,speakerLinkedIn:a.speakerLinkedIn,hook:a.hook,keynoteNotesUrl:a.keynoteNotesUrl,keynoteSlidesUrl:a.keynoteSlidesUrl,contactEmail:a.contactEmail,calendarLink:a.calendarLink,newsletterEnabled:a.newsletterEnabled,newsletterDescription:a.newsletterDescription,newsletterSignupUrl:a.newsletterSignupUrl,newsletterBannerUrl:a.newsletterBannerUrl}}),a.customGpts&&(await e.customGPT.deleteMany({where:{talkPageId:t.id}}),a.customGpts.length>0&&await e.customGPT.createMany({data:a.customGpts.map((e,a)=>({name:e.name,description:e.description,url:e.url,order:e.order??a,talkPageId:t.id}))})),a.downloads&&(await e.download.deleteMany({where:{talkPageId:t.id}}),a.downloads.length>0&&await e.download.createMany({data:a.downloads.map((e,a)=>({title:e.title,description:e.description,fileUrl:e.fileUrl,requiresEmail:e.requiresEmail??!1,order:e.order??a,talkPageId:t.id}))})),a.businessLinks&&(await e.businessLink.deleteMany({where:{talkPageId:t.id}}),a.businessLinks.length>0&&await e.businessLink.createMany({data:a.businessLinks.map((e,a)=>({name:e.name,description:e.description,url:e.url,ctaText:e.ctaText||"Learn More",order:e.order??a,talkPageId:t.id}))})),await e.talkPage.findUnique({where:{id:t.id},include:{customGpts:!0,downloads:!0,businessLinks:!0}})));return o.NextResponse.json(r)}catch(e){return console.error("Error updating talk page:",e),o.NextResponse.json({error:"Failed to update talk page"},{status:500})}}async function p(e,{params:t}){try{if(!e.cookies.get("userId")?.value)return o.NextResponse.json({error:"Unauthorized"},{status:401});return await d._.talkPage.delete({where:{id:t.id}}),o.NextResponse.json({success:!0})}catch(e){return console.error("Error deleting talk page:",e),o.NextResponse.json({error:"Failed to delete talk page"},{status:500})}}let c=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/talk-pages/[id]/route",pathname:"/api/talk-pages/[id]",filename:"route",bundlePath:"app/api/talk-pages/[id]/route"},resolvedPagePath:"/Users/noahcheyer/MicDrop/app/api/talk-pages/[id]/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:k,staticGenerationAsyncStorage:g,serverHooks:w}=c,m="/api/talk-pages/[id]/route";function h(){return(0,i.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:g})}},9487:(e,t,a)=>{a.d(t,{_:()=>s});var r=a(3524);a(2237);let s=global.prisma||new r.PrismaClient({log:["error"]})}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[948,972,237],()=>a(195));module.exports=r})();