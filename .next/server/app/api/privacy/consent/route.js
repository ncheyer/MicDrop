"use strict";(()=>{var e={};e.id=532,e.ids=[532],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7710:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>x,patchFetch:()=>g,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>v,staticGenerationAsyncStorage:()=>m});var n={};t.r(n),t.d(n,{GET:()=>p,POST:()=>u});var s=t(9303),o=t(8716),a=t(670),i=t(7070),c=t(2331);async function u(e){try{let r=await e.json(),t=e.headers.get("x-forwarded-for"),n=e.headers.get("x-real-ip"),s=t?.split(",")[0]||n||"unknown";return await c._.consentRecord.create({data:{userId:r.userId||null,email:r.email||null,ipAddress:s,userAgent:r.userAgent||"unknown",preferences:r.preferences,timestamp:new Date(r.timestamp),version:r.version,source:r.source}}),i.NextResponse.json({success:!0})}catch(e){return console.error("Error storing consent record:",e),i.NextResponse.json({error:"Failed to store consent"},{status:500})}}async function p(e){try{let{searchParams:r}=new URL(e.url),t=r.get("userId"),n=r.get("email");if(!t&&!n)return i.NextResponse.json({error:"User ID or email required"},{status:400});let s=await c._.consentRecord.findFirst({where:{OR:[{userId:t||void 0},{email:n||void 0}]},orderBy:{timestamp:"desc"}});return i.NextResponse.json(s)}catch(e){return console.error("Error retrieving consent record:",e),i.NextResponse.json({error:"Failed to retrieve consent"},{status:500})}}let d=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/privacy/consent/route",pathname:"/api/privacy/consent",filename:"route",bundlePath:"app/api/privacy/consent/route"},resolvedPagePath:"/Users/noahcheyer/MicDrop/app/api/privacy/consent/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:v}=d,x="/api/privacy/consent/route";function g(){return(0,a.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:m})}},2331:(e,r,t)=>{t.d(r,{_:()=>s});var n=t(3524);let s=globalThis.prisma||new n.PrismaClient}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[948,972],()=>t(7710));module.exports=n})();